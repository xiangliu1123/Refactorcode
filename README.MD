Refactoring code and put them into src and test file.
